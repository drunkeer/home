<!DOCTYPE html>
<html style="height: 100%;width:100%">

<head>
    <meta charset="utf-8">
</head>

<body style="height: 100%; width:100%">
    <hr style="border: 2px solid red;">
    <div id="chart-panel" style="height: 100%;width: 100%"></div>
    <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/dist/echarts.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>

    <script type="text/javascript">
        var dom = document.getElementById("chart-panel");
        var myChart = echarts.init(dom);
        var option;
        var app = {};
        var uploadedDataURL = "https://geo.datav.aliyun.com/areas_v3/bound/340000_full.json";
        var anhui = "https://geo.datav.aliyun.com/areas_v3/bound/340000_full.json";
        var hefei = "https://geo.datav.aliyun.com/areas_v3/bound/340100_full.json";
        var huaibei = "https://geo.datav.aliyun.com/areas_v3/bound/340600_full.json";
        var suzhou = "https://geo.datav.aliyun.com/areas_v3/bound/341300_full.json";
        var bozhou = "https://geo.datav.aliyun.com/areas_v3/bound/341600_full.json";
        var fuyang = "https://geo.datav.aliyun.com/areas_v3/bound/341200_full.json";
        var huainan = "https://geo.datav.aliyun.com/areas_v3/bound/340400_full.json";
        var bengbu = "https://geo.datav.aliyun.com/areas_v3/bound/340300_full.json";
        var chuzhou = "https://geo.datav.aliyun.com/areas_v3/bound/341100_full.json";
        var luan = "https://geo.datav.aliyun.com/areas_v3/bound/341500_full.json";
        var maanshan = "https://geo.datav.aliyun.com/areas_v3/bound/340500_full.json";
        var wuhu = "https://geo.datav.aliyun.com/areas_v3/bound/340200_full.json";
        var tongling = "https://geo.datav.aliyun.com/areas_v3/bound/340700_full.json";
        var anqing = "https://geo.datav.aliyun.com/areas_v3/bound/340800_full.json";
        var chizhou = "https://geo.datav.aliyun.com/areas_v3/bound/341700_full.json";
        var xuancheng = "https://geo.datav.aliyun.com/areas_v3/bound/341800_full.json";
        var huangshan = "https://geo.datav.aliyun.com/areas_v3/bound/341000_full.json";


        $.get(uploadedDataURL, function (geoJson) {

            myChart.hideLoading();

            echarts.registerMap('安徽', geoJson);

            var cityMap = {
                "淮南市": huainan,
                "滁州市": chuzhou,
                "阜阳市": fuyang,
                "蚌埠市": bengbu,
                "宿州市": suzhou,
                "合肥市": hefei,
                "马鞍山市": maanshan,
                "六安市": luan,
                "淮北市": huaibei,
                "芜湖市": wuhu,
                "亳州市": bozhou,
                "铜陵市": tongling,
                "安庆市": anqing,
                "池州市": chizhou,
                "宣城市": xuancheng,
                "黄山市": huangshan,
            };

            var gdGeoCoordMap = {
                '合肥市': [117.233674, 31.826972],
                "滁州市": [118.33985, 32.262231],
                "阜阳市": [118.33985, 32.262231],
                "蚌埠市": [117.395132, 32.923064],
                "宿州市": [116.970755, 33.653347],
                "淮南市": [117.024941, 32.591577],
                "马鞍山市": [118.513461, 31.674488],
                "六安市": [116.526244, 31.742236],
                "淮北市": [116.80488, 33.96211],
                "芜湖市": [118.439467, 31.358947],
                "亳州市": [115.785069, 33.851205],
                "铜陵市": [117.817692, 30.951211],
                "安庆市": [117.121297, 30.539186],
                "池州市": [117.499424, 30.678605],
                "宣城市": [118.76561, 30.945293],
                "黄山市": [118.343814, 29.720832],
            };
            var gdDatas = [
                [{
                    name: '合肥市',
                    value: 10
                }],
                [{
                    name: '淮北市',
                    value: 0
                }],
                [{
                    name: '宿州市',
                    value: 0
                }],
                [{
                    name: '阜阳市',
                    value: 0
                }],
                [{
                    name: '亳州市',
                    value: 1.3
                }],
                [{
                    name: '蚌埠市',
                    value: 0.2
                }],
                [{
                    name: '淮南市',
                    value: 0.4
                }],
                [{
                    name: '滁州市',
                    value: 0.6
                }],
                [{
                    name: '六安市',
                    value: 0.8
                }],
                [{
                    name: '芜湖市',
                    value: 0.4
                }],
                [{
                    name: '宣城市',
                    value: 0.8
                }],
                [{
                    name: '安庆市',
                    value: 0.2
                }],
                [{
                    name: '铜陵市',
                    value: 1.3
                }],
                [{
                    name: '池州市',
                    value: 0
                }],
                [{
                    name: '黄山市',
                    value: 0
                }],
                [{
                    name: '马鞍山市',
                    value: 0
                }]

            ];

            var hefeidata = [{
                name: "肥东县",
                value: [117.474833, 31.897651, 0.5],
            },
            {
                name: "长丰县",
                value: [117.165691, 32.482499, 1],
            },

            ]

            var huabeidata = [{
                name: "濉溪县",
                value: [116.770672, 33.921772, 0.5],
            },

            ]

            var suzhoudata = [{
                name: "砀山县",
                value: [116.362471, 34.429961, 0.5],
            },

            ]

            var fuyangdata = [{
                name: "太和县",
                value: [115.62839, 33.164315, 0.5],
            },

            ]

            var bozhoudata = [{
                name: "蒙城县",
                value: [116.541398, 33.231505, 0.5],
            },

            ]

            var bengbudata = [{
                name: "怀远县",
                value: [117.211039, 32.979285, 0.5],
            },

            ]

            var huainandata = [{
                name: "寿县",
                value: [116.805237, 32.550756, 0.5],
            },

            ]

            var chouzhoudata = [{
                name: "定远县",
                value: [117.709346, 32.539557, 0.5],
            },

            ]

            var wuhudata = [{
                name: "繁昌县",
                value: [118.204423, 31.085473, 0.5],
            },

            ]

            var tonglingdata = [{
                name: "枞阳县",
                value: [117.274281, 30.712256, 0.5],
            },

            ]

            var maanshandata = [{
                name: "和县",
                value: [118.376077, 31.72211, 0.5],
            },

            ]

            var luandata = [{
                name: "金寨县",
                value: [115.939217, 31.733797, 0.5],
            },

            ]

            var anqingdata = [{
                name: "太湖县",
                value: [116.315752, 30.457424, 0.5],
            },

            ]

            var xuanchengdata = [{
                name: "泾县",
                value: [118.431329, 30.701541, 0.5],
            },

            ]

            var huangshandata = [{
                name: "歙县",
                value: [118.419594, 29.869096, 0.5],
            },


            ]

            var chizhoudata = [{
                name: "青阳县",
                value: [117.863809, 30.643217, 0.5],
            },
            ]

            var opt = {
                bgColor: '#013954', // 画布背景色
                mapName: '安徽', // 地图名
                goDown: true, // 是否下钻
                // 下钻回调
                callback: function (name, option, instance) {
                    console.log(name, option, instance);
                    if (name == '安徽') {
                        option.series[0].data = convertData(gdDatas);
                        option.series[1].data = gdDatas.map(function (dataItem) {
                            return {
                                name: dataItem[0].name,
                                value: gdGeoCoordMap[dataItem[0].name].concat([dataItem[0].value])
                            };
                        });
                        myChart.setOption(option, true);
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "合肥市") {
                        option.series[0].data = convertData1(hefeidata);
                        option.series[1].data = hefeidata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "淮北市") {
                        option.series[0].data = convertData1(huaibeidata);
                        option.series[1].data = huaibeidata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "宿州市") {
                        option.series[0].data = convertData1(suzhoudata);
                        option.series[1].data = suzhoudata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "阜阳市") {
                        option.series[0].data = convertData1(fuyangdata);
                        option.series[1].data = fuyangdata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "亳州市") {
                        option.series[0].data = convertData1(bozhoudata);
                        option.series[1].data = bozhoudata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "蚌埠市") {
                        option.series[0].data = convertData1(bengbudata);
                        option.series[1].data = bengbudata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "淮南市") {
                        option.series[0].data = convertData1(huainandata);
                        option.series[1].data = huainandata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "滁州市") {
                        option.series[0].data = convertData1(chuzhoudata);
                        option.series[1].data = chuzhoudata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "芜湖市") {
                        option.series[0].data = convertData1(wuhudata);
                        option.series[1].data = wuhudata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "铜陵市") {
                        option.series[0].data = convertData1(tonglingdata);
                        option.series[1].data = tonglingdata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "马鞍山市") {
                        option.series[0].data = convertData1(maanshandata);
                        option.series[1].data = maanshandata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "六安市") {
                        option.series[0].data = convertData1(luandata);
                        option.series[1].data = luandata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "安庆市") {
                        option.series[0].data = convertData1(anqingdata);
                        option.series[1].data = anqingdata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "宣城市") {
                        option.series[0].data = convertData1(xuanchengdata);
                        option.series[1].data = xuanchengdata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "池州市") {
                        option.series[0].data = convertData1(chizhoudata);
                        option.series[1].data = chizhoudata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)
                    } else if (name == "黄山市") {
                        option.series[0].data = convertData1(huangshandata);
                        option.series[1].data = huangshandata;
                        myChart.setOption(option, true); // 赋值后初始化
                        setTimeout(() => { // 定时后启动飞线
                            myChart.setOption(option, true);
                        }, 500)

                    }
                },
                // 数据展示            	
                data: []
            };


            var levelColorMap = { // level颜色
                '1': '#f44336',
                '2': '#fc9700',
                '3': '#ffde00',
                '4': '#00eaff'
            };

            var defaultOpt = {
                mapName: 'china', // 地图展示
                goDown: false, // 是否下钻
                bgColor: '#013954', // 画布背景色
                activeArea: [], // 区域高亮,同echarts配置项
                data: [],
                // 下钻回调(点击的地图名、实例对象option、实例对象)
                callback: function (name, option, instance) { }
            };
            if (opt) {
                opt1 = $.extend(defaultOpt, opt);
            }

            // 层级索引
            var name = [opt1.mapName];
            var idx = 0;
            var pos = { //层级位置
                leftPlus: 55,
                leftCur: 50,
                left: 10,
                top: 10
            };

            var line = [ //箭头
                [0, 0],
                [8, 11],
                [0, 22]
            ];

            // style样式
            var style = {
                font: '18px "Microsoft YaHei", sans-serif',
                textColor: '#eee',
                lineColor: 'rgba(147, 235, 248, .8)'
            };


            var handleEvents = {
                /**
                 * i 实例对象
                 * o option
                 * n 地图名
                 **/
                resetOption: function (i, o, n) {
                    console.log(i)
                    console.log(o)
                    console.log(n)
                    var breadcrumb = this.createBreadcrumb(n);

                    var j = name.indexOf(n);
                    var l = o.graphic.length;
                    if (j < 0) {
                        console.log('jinru1')
                        o.graphic.push(breadcrumb);
                        o.graphic[0].children[0].shape.x2 = 195;
                        o.graphic[0].children[1].shape.x2 = 195;
                        if (o.graphic.length > 2) {
                            for (var x = 0; x < opt1.data.length; x++) {
                                if (n === opt1.data[x].name + '市') {
                                    o.series[0].data = handleEvents.initSeriesData(opt1.data[x].data);
                                    break;
                                } else o.series[0].data = [];
                            }
                        }
                        name.push(n);
                        idx++;
                    } else {
                        console.log('jinru2', j)
                        o.graphic.splice(j + 2, l);
                        if (o.graphic.length <= 2) {
                            o.graphic[0].children[0].shape.x2 = 85;
                            o.graphic[0].children[1].shape.x2 = 85;
                            o.series[0].data = handleEvents.initSeriesData(gdDatas);
                        }
                        name.splice(j + 1, l);
                        idx = j;
                        pos.leftCur -= pos.leftPlus * (l - j - 1);
                    }

                    o.geo.map = n;
                    o.geo.zoom = 1;
                    i.clear();
                    i.setOption(o);
                    this.zoomAnimation();
                    opt1.callback(n, o, i);
                },

                /**
                 * name 地图名
                 **/
                createBreadcrumb: function (name) {
                    var cityToPinyin = {
                        "淮南市": "huainan",
                        "滁州市": "chuzhou",
                        "阜阳市": "fuyang",
                        "蚌埠市": "bengbu",
                        "宿州市": "suzhou",
                        "合肥市": "hefei",
                        "马鞍山市": "maanshan",
                        "六安市": "luan",
                        "淮北市": "huaibei",
                        "芜湖市": "wuhu",
                        "亳州市": "bozhou",
                        "铜陵市": "tongling",
                        "安庆市": "anqing",
                        "池州市": "chizhou",
                        "宣城市": "xuancheng",
                        "黄山市": "huangshan",
                    };
                    var breadcrumb = {
                        type: 'group',
                        id: name,
                        left: pos.leftCur + pos.leftPlus,
                        top: pos.top + 3,
                        children: [{
                            type: 'polyline',
                            left: -90,
                            top: -5,
                            shape: {
                                points: line
                            },
                            style: {
                                stroke: '#fff',
                                key: name,
                            },
                            onclick: function () {
                                var name = this.style.key;
                                handleEvents.resetOption(myChart, option, name);
                            }
                        }, {
                            type: 'text',
                            left: -68,
                            top: 'middle',
                            style: {
                                text: name,
                                textAlign: 'center',
                                fill: style.textColor,
                                font: style.font
                            },
                            onclick: function () {
                                var name = this.style.text;
                                handleEvents.resetOption(myChart, option, name);
                            }
                        }, {
                            type: 'text',
                            left: -68,
                            top: 10,
                            style: {

                                name: name,
                                text: cityToPinyin[name] ? cityToPinyin[name].toUpperCase() : '',
                                textAlign: 'center',
                                fill: style.textColor,
                                font: '12px "Microsoft YaHei", sans-serif',
                            },
                            onclick: function () {
                                // console.log(this.style);
                                var name = this.style.name;
                                handleEvents.resetOption(myChart, option, name);
                            }
                        }]
                    }

                    pos.leftCur += pos.leftPlus;

                    return breadcrumb;
                },

                // 设置effectscatter
                initSeriesData: function (data) {
                    console.log(data, '22222222222')
                    var temp = [];
                    for (var i = 0; i < data.length; i++) {
                        var geoCoord = gdGeoCoordMap[data[i].name];
                        if (geoCoord) {
                            temp.push({
                                name: data[i].name,
                                value: geoCoord.concat(data[i].value, data[i].level)
                            });
                        }
                    }
                    return temp;
                },

                zoomAnimation: function () {
                    var count = null;
                    var zoom = function (per) {
                        if (!count) count = per;
                        count = count + per;
                        // console.log(per,count);
                        myChart.setOption({
                            geo: {
                                zoom: count
                            }
                        });
                        if (count < 1) window.requestAnimationFrame(function () {
                            zoom(0.2);
                        });
                    };
                    window.requestAnimationFrame(function () {
                        zoom(0.2);
                    });
                }
            };

            var convertData = function (data) {

                var res = [];
                for (var i = 0; i < data.length; i++) {
                    var dataItem = data[i];
                    var name = dataItem[0].name
                    var fromCoord = gdGeoCoordMap[dataItem[0].name];
                    var toCoord = [104.07754, 30.582248]; //被攻击点坐标
                    if (fromCoord && toCoord) {
                        res.push([{
                            name: name,
                            coord: fromCoord,
                            value: dataItem[0].value
                        }, {
                            coord: toCoord,
                        }]);
                    }
                }
                return res;
            };

            var convertData1 = function (data) {
                var res = [];
                for (var i = 0; i < data.length; i++) {
                    var dataItem = data[i];
                    var name = dataItem.name
                    var fromCoord = data[0].value.slice(0, 2)
                    var toCoord = dataItem.value.slice(0, 2)
                    if (fromCoord && toCoord) {
                        res.push([{
                            name: name,
                            coord: fromCoord,
                            value: dataItem.value[2],
                        }, {
                            coord: toCoord,
                        }]);
                    }
                }
                return res;
            };

            var series = [];
            [
                ['合肥市', gdDatas]
            ].forEach(function (item, i) {
                console.log(item)
                series.push(
                    //     {
                    //     type: 'lines',
                    //     zlevel: 1,
                    //     effect: {
                    //         show: true,
                    //         period: 3, //箭头指向速度，值越小速度越快
                    //         trailLength: 0.7, //特效尾迹长度[0,1]值越大，尾迹越长重
                    //         color: '#fff', //箭头图标
                    //         symbolSize: 3, //图标大小
                    //     },
                    //     lineStyle: {
                    //         normal: {
                    //             width: 0.1, //尾迹线条宽度
                    //             opacity: 0.2, //尾迹线条透明度
                    //             curveness: 0.3 //尾迹线条曲直度
                    //         }
                    //     },
                    //     data: convertData(item[1])
                    // }, 
                    {
                        type: 'effectScatter',
                        coordinateSystem: 'geo',
                        zlevel: 2,
                        rippleEffect: { //涟漪特效
                            period: 4, //动画时间，值越小速度越快
                            brushType: 'stroke', //波纹绘制方式 stroke, fill
                            scale: 4 //波纹圆环最大限制，值越大波纹越大
                        },
                        label: {
                            normal: {
                                show: false,
                                position: 'right', //显示位置
                                offset: [5, 0], //偏移设置
                                formatter: function (params) { //圆环显示文字
                                    return params.data.name;
                                },
                                fontSize: 19
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        symbol: 'circle',
                        symbolSize: function (val) {
                            return 10 + val[2] * 0; //圆环大小
                        },
                        itemStyle: {
                            normal: {
                                show: false,
                                color: '#f00'
                            }
                        },
                        data: item[1].map(function (dataItem) {
                            return {
                                name: dataItem[0].name,
                                value: gdGeoCoordMap[dataItem[0].name].concat([dataItem[0].value])
                            };
                        }),
                    },
                    //被攻击点
                    {
                        type: 'scatter',
                        coordinateSystem: 'geo',
                        zlevel: 2,
                        rippleEffect: {
                            period: 4,
                            brushType: 'stroke',
                            scale: 4
                        },
                        label: {
                            normal: {
                                show: false,
                                position: 'right',
                                //offset:[5, 0],
                                color: '#0f0',
                                formatter: '{b}',
                                textStyle: {
                                    color: "#0f0"
                                }
                            },
                            emphasis: {
                                show: false,
                                color: "#f60"
                            }
                        },
                        // symbol: 'pin',
                        // symbolSize: 50,
                        // data: [{
                        //     name: item[0],
                        //     value: gdGeoCoordMap[item[0]].concat([10]),
                        // }],
                    }
                );
            });









            option = {
                "tooltip": {
                    trigger: 'item',
                    backgroundColor: 'rgba(0,0,0,0)',
                    formatter: function (item) {
                        console.log(item, 'item!!!!')
                        if (item.componentSubType === 'lines') {
                            var tipHtml1 = '';
                            tipHtml1 = '<div style="background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666">' +
                                '<div style="color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;">' + item.data.name + '</div>' +
                                '<div style="text-align:center;color:#494949;padding:8px 6px">' +
                                '<span style="font-size:18px;font-weight:bold;">' + '县级融媒体中心数量：' + item.data.value + ' ' + '</span>' +
                                '</div>' + '</div>';
                            return tipHtml1;
                        } else if (item.componentSubType === 'effectScatter') {
                            var tipHtml2 = '';
                            tipHtml2 = '<div style="background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666">' +
                                '<div style="color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;">' + item.data.name + '</div>' +
                                '<div style="text-align:center;color:#494949;padding:8px 6px">' +
                                '<span style="font-size:18px;font-weight:bold;">' + '县级融媒体中心数量：' + item.data.value[2] + ' ' + '</span>' +
                                '</div>' + '</div>';
                            return tipHtml2;
                        } else if (item.componentSubType === 'scatter') {
                            var tipHtml3 = '';
                            tipHtml3 = '<div style="background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666">' +
                                '<div style="color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;">' + item.data.name + '</div>' +
                                '<div style="text-align:center;color:#494949;padding:8px 6px">' +
                                '<span style="font-size:18px;font-weight:bold;">' + '县级融媒体中心数量：' + item.data.value[2] + ' ' + '</span>' +
                                '</div>' + '</div>';
                            return tipHtml3;
                        }
                    }
                },
                backgroundColor: "#013954",
                "graphic": [{
                    type: 'group',
                    left: pos.left,
                    top: pos.top - 4,
                    children: [{
                        type: 'line',
                        left: 0,
                        top: -20,
                        shape: {
                            x1: 0,
                            y1: 0,
                            x2: 85,
                            y2: 0
                        },
                        style: {
                            stroke: style.lineColor,
                        }
                    }, {
                        type: 'line',
                        left: 0,
                        top: 20,
                        shape: {
                            x1: 0,
                            y1: 0,
                            x2: 85,
                            y2: 0
                        },
                        style: {
                            stroke: style.lineColor,
                        }
                    }]
                }, {
                    id: name[idx],
                    type: 'group',
                    left: pos.left + 2,
                    top: pos.top,
                    children: [{
                        type: 'polyline',
                        left: 90,
                        top: -12,
                        shape: {
                            points: line
                        },
                        style: {
                            stroke: 'transparent',
                            key: name[0]
                        },
                        onclick: function () {
                            var name = this.style.key;
                            console.log(name, '111111')
                            handleEvents.resetOption(myChart, option, name);
                        }
                    }, {
                        type: 'text',
                        left: 0,
                        top: 'middle',
                        style: {
                            text: name[0] === '安徽' ? '安徽省' : name[0],
                            textAlign: 'center',
                            fill: style.textColor,
                            font: style.font
                        },
                        onclick: function () {
                            handleEvents.resetOption(myChart, option, '安徽');
                        }
                    }, {
                        type: 'text',
                        left: 0,
                        top: 10,
                        style: {
                            text: 'ANHUI',
                            textAlign: 'center',
                            fill: style.textColor,
                            font: '12px "Microsoft YaHei", sans-serif',
                        },
                        onclick: function () {
                            handleEvents.resetOption(myChart, option, '安徽');
                        }
                    }]
                }],
                visualMap: { //图例值控制
                    min: 0,
                    max: 1,
                    calculable: true,
                    show: false,
                    color: ['#f44336', '#fc9700', '#ffde00', '#ffde00', '#00eaff'],
                    textStyle: {
                        color: '#fff'
                    }
                },
                "geo": {
                    "map": "安徽",
                    "layoutCenter": ["55%", "50%"],
                    "layoutSize": "109%",
                    "label": {
                        "normal": {
                            "show": true,
                            "textStyle": {
                                "color": '#fff'
                            }
                        },
                        "emphasis": {
                            "textStyle": {
                                "color": '#fff'
                            }
                        }
                    },
                    "roam": true, //是否允许缩放
                    "mapLocation": {
                        "width": "110%",
                        "height": "97%"
                    },

                    "itemStyle": {
                        "normal": {
                            borderColor: 'rgba(147, 235, 248, 1)',
                            borderWidth: 1,
                            areaColor: {
                                type: 'radial',
                                x: 0.5,
                                y: 0.5,
                                r: 0.8,
                                colorStops: [{
                                    offset: 0,
                                    color: 'rgba(147, 235, 248, 0)' // 0% 处的颜色
                                }, {
                                    offset: 1,
                                    color: 'rgba(147, 235, 248, .2)' // 100% 处的颜色
                                }],
                                globalCoord: false // 缺省为 false
                            },
                            shadowColor: 'rgba(128, 217, 248, 1)',
                            // shadowColor: 'rgba(255, 255, 255, 1)',
                            shadowOffsetX: -2,
                            shadowOffsetY: 2,
                            shadowBlur: 10
                        },
                        "emphasis": {
                            itemStyle: {
                                areaColor: '#FFD181',
                                borderColor: '#404a59',
                                borderWidth: 1
                            }
                        }
                    }
                },
                series: series
            },
                myChart.setOption(option);
            myChart.on('click', function (params) {
                console.log(params)
                var _self = this;
                if (cityMap[params.name]) {
                    var url = cityMap[params.name];
                    $.get(url, function (response) {
                        //console.log(response, 'res');
                        curGeoJson = response;
                        echarts.registerMap(params.name, response);
                        handleEvents.resetOption(_self, option, params.name);
                    });
                }
            });
        });
        if (option && typeof option === 'object') {
            myChart.setOption(option);
        }
    </script>
</body>

</html>
